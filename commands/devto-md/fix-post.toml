title = "Process Markdown for Dev.to Publication"
description = "Fix markdown content for Dev.to publication"
prompt = """
You are an expert technical editor. Your goal is to "fix" the supplied markdown content so that it is suitable for a Dev.to post.

Apply the following rules to the content:

1. **Insert a blank line after all markdown headings**: In the raw md, any heading should have a blank line after it, before the content.
   If the first heading of the document is not at H1, fix it.
2. **Remove Highlights**: Remove any lines that match the pattern "<User Name> highlighted". 
   These artifacts often appear in exports from other platforms.
3. **Fix Code Blocks**: Look for triple-backtick code blocks that are missing a language identifier. 
   Examine the code inside and add the correct language prefix (e.g., `python`, `bash`, `javascript`, etc.).
4. **Remove Unnecessary Escapes**: Look for escape characters that are not required. 
   E.g. `code\\_styleguides` should be `code_styleguides`.
   E.g. \\*\\*Summarize Files\\*\\* -> **Summarize Files**.
   E.g. **file\\_reader\\_agent** should be **file_reader_agent**.
5. **Format Inline Variables**: Look for strings in the text (NOT inside existing code blocks or links) that appear to be variables (snake_case) or file paths. 
   Wrap them in single backticks so they render as inline code.
   E.g. file_reader_agent -> `file_reader_agent`
   E.g. **file_reader_agent** -> `**file_reader_agent**`
6. **Fix Image Captions**: Convert split image/caption styling to standard Markdown image syntax. E.g.
   - Before fixing:
     ![](https://example.com/image.png)
     _My Caption_
   - After fixing:
     ![My Caption](https://example.com/image.png)
7. **Frontmatter Check**: Ensure valid YAML frontmatter exists at the top.
   - If missing, create it.
   - Ensure the following keys exist (add with placeholders/defaults if missing):
     - `title`: Extract from the first H1 or use "TODO: Title"
     - `published`: false
     - `tags`: todo1, todo2
     - `canonical_url`: "TODO"
     - `cover_image`: "TODO"
8. **Liquid Tags**: Convert standalone Twitter and YouTube links to Dev.to Liquid tags.
   - Twitter/X: `https://twitter.com/user/status/123` or `x.com/...` -> `{% twitter 123 %}`
   - YouTube: `https://youtube.com/watch?v=123` or `youtu.be/123` -> `{% youtube 123 %}`
   - **Exception**: DO NOT convert GitHub links to liquid tags; keep them as standard links.
9. **Check heading structure**: The post title should only be in the front matter `title`. It should not be repeated in the markdown content.
   Subsequently, all top-level headings in the md content should be H2 (##). Ensure that sub-headings are at the appropriate level. 


Output ONLY the fixed markdown content. Do not include any conversational preamble. Do not wrap in additional tags.

<input_markdown>
{{args}}
</input_markdown>
"""
